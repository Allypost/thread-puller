<h1 class="no-select topbar">
    <a href="/<%= board -%>/">Back</a>
    <span id="download" data-shown="no" data-board="<%= board -%>" data-thread="<%= thread -%>"></span>
    <a href="<%= threadUrl -%>" target="_blank" rel="noopener noreferrer">Go to thread</a>
</h1>
<h1 class="no-select">Board:
    <span class="title-text">/<%= board -%>/</span>
</h1>
<h1 class="no-select">Thread:
    <span class="title-text"><%- postTitle -%></span>
</h1>

<% posts.filter((post) => post.file).forEach((post) => { -%>
    <%
        const postUrl = `https://boards.4chan.org/${post.board}/thread/${post.thread}#p${post.id}`;
        const isVideo = post.file.meta.isVideo;
        const loading = isVideo ? '' : 'loading';

        const postId = `p${post.id}`;
    -%>
    <div id="<%- postId -%>" class="resource <%- loading -%>">
        <% if (isVideo) { -%>
            <%- include ./assets/video.ejs -%>
        <% } else { -%>
            <%- include ./assets/image.ejs -%>
        <% } -%>
        <div class="resource-footer">
            <% if(post.meta.replies) { -%>
                <span class="resource-footer-button left" data-replies="<%- post.meta.replies_list.join(',') -%>">Replies: <%- post.meta.replies -%></span>
            <% } -%>
            <a class="resource-footer-button center" href="<%- postUrl -%>" target="_blank" rel="noopener noreferrer">Go to post</a>
            <% if(post.meta.mentions) { -%>
                <span class="resource-footer-button right" data-mentions="<%- post.meta.mentions_list.join(',') -%>">Mentions: <%- post.meta.mentions -%></span>
            <% } -%>
            <a class="resource-footer-button link" href="#<%- postId -%>" alt="Link to this post" title="Link to this post"></a>
        </div>
    </div>
<% }) -%>

<script>
    (function () {
        Thread.init();
    })();
</script>
